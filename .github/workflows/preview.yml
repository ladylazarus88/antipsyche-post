name: âš¡ Simple Preview

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  preview:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          repository: ladylazarus88/antipsyche-post
          
      - name: ğŸ“ Create basic preview
        run: |
          mkdir -p _site
          
          # Crea HTML semplice
          cat > _site/index.html << 'EOF'
          <html>
          <head><title>Preview</title></head>
          <body>
            <h1>Post Preview</h1>
            <ul>
          EOF
          
          # Lista file
          if [ -d "posts" ]; then
            for file in posts/*.md; do
              if [ -f "$file" ]; then
                title=$(basename "$file" .md)
                echo "<li>$title</li>" >> _site/index.html
              fi
            done
          fi
          
          cat >> _site/index.html << 'EOF'
            </ul>
          </body>
          </html>
          EOF
          
          echo "File creato!"
          ls -la _site/
          
      - name: ğŸ“¤ Upload artifact
        uses: actions/upload-pages-artifact@v2
        with:
          path: _site
          
      - name: ğŸŒ Deploy
        uses: actions/deploy-pages@v3
